<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interim Benefit Offer Response</title>
    <style>
        /* --- DESIGN SYSTEM & SLDS PATTERNS --- */
        :root {
            /* Legal Aid Colour Palette */
            --brand-primary-red: #C10E02;
            --brand-trusted-blue: #004A80;
            --brand-calming-green: #21A179;
            --brand-dark-grey: #1D1D1D;
            --brand-mid-grey: #545454;
            --brand-light-grey: #919191;
            --brand-border-grey: #E6E6E6;
            --brand-background-grey: #F4F5F6;
            --brand-white: #FFFFFF;
            --brand-error-red: #C23934;
            --brand-focus-shadow: 0 0 3px 1px #51A2E8;

            /* Spacing Tokens (8px grid) */
            --spacing-x-small: 4px;
            --spacing-small: 8px;
            --spacing-medium: 16px;
            --spacing-large: 24px;
            --spacing-x-large: 32px;

            /* Typography */
            --font-family-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';

            /* Border Radius */
            --border-radius-medium: 4px;
        }

        /* --- BASE STYLES & RESET --- */
        *, *::before, *::after {
            box-sizing: border-box;
        }

        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: var(--font-family-sans);
            background-color: var(--brand-background-grey);
            color: var(--brand-dark-grey);
            font-size: 16px;
        }

        /* --- TYPOGRAPHY --- */
        .heading-1 { /* H1 */
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
            color: var(--brand-dark-grey);
            margin: 0 0 var(--spacing-medium) 0;
        }
        .heading-3 { /* H3 */
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.3;
            color: var(--brand-dark-grey);
            margin: 0 0 var(--spacing-small) 0;
        }
        .body-large { /* Body 1 */
            font-size: 1rem;
            line-height: 1.5;
        }
        .body-paragraph { /* Body 2 */
            font-size: 0.875rem;
            line-height: 1.5;
            color: var(--brand-mid-grey);
        }
        .body-small-strong {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--brand-mid-grey);
        }
        .footnote {
            font-size: 0.75rem;
            color: var(--brand-light-grey);
        }

        /* --- LAYOUT & CONTAINER --- */
        .page-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--spacing-large);
            min-height: 100vh;
        }

        .form-card {
            background-color: var(--brand-white);
            border-radius: var(--border-radius-medium);
            box-shadow: 0 2px 4px rgba(0,0,0,0.07);
            width: 100%;
            max-width: 720px;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .card-header {
            padding: var(--spacing-large);
            border-bottom: 1px solid var(--brand-border-grey);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .logo {
            width: 150px;
            height: auto;
            margin-bottom: var(--spacing-medium);
        }

        .card-body {
            padding: var(--spacing-large);
        }

        .card-footer {
            padding: var(--spacing-medium) var(--spacing-large);
            background-color: var(--brand-background-grey);
            border-top: 1px solid var(--brand-border-grey);
            border-bottom-left-radius: var(--border-radius-medium);
            border-bottom-right-radius: var(--border-radius-medium);
            text-align: right;
        }

        .form-section {
            padding: var(--spacing-large) 0;
            border-bottom: 1px solid var(--brand-border-grey);
        }
        .form-section:last-of-type {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-medium);
            margin-bottom: var(--spacing-large);
        }

        @media (min-width: 600px) {
            .info-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* --- SLDS FORM ELEMENT PATTERNS --- */
        .slds-form-element {
            margin-bottom: var(--spacing-medium);
        }
        .slds-form-element__label {
            display: block;
            margin-bottom: var(--spacing-small);
            font-weight: 600;
            font-size: 0.875rem;
        }
        .slds-form-element__control {
            position: relative;
        }
        .slds-input, .slds-select {
            width: 100%;
            padding: var(--spacing-small) var(--spacing-medium);
            border: 1px solid var(--brand-light-grey);
            border-radius: var(--border-radius-medium);
            background-color: var(--brand-white);
            font-size: 1rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .slds-input:focus, .slds-select:focus {
            outline: none;
            border-color: var(--brand-trusted-blue);
            box-shadow: var(--brand-focus-shadow);
        }
        .slds-input[readonly] {
            background-color: var(--brand-background-grey);
            border-color: var(--brand-border-grey);
            cursor: not-allowed;
        }

        /* Custom Radio & Checkbox (CRITICAL: Red selected state) */
        .slds-radio, .slds-checkbox {
            margin-bottom: var(--spacing-medium);
        }
        .slds-radio label, .slds-checkbox label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 1rem;
        }
        .slds-radio input, .slds-checkbox input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        .control-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: var(--spacing-medium);
            background: var(--brand-white);
            border: 2px solid var(--brand-light-grey);
            transition: all 0.2s ease;
            position: relative;
        }
        .slds-radio .control-indicator {
            border-radius: 50%;
        }
        .slds-checkbox .control-indicator {
            border-radius: var(--border-radius-medium);
        }
        .slds-radio input:checked ~ .control-indicator {
            border-color: var(--brand-primary-red);
        }
        /* INNER DOT: MUST BE RED */
        .slds-radio input:checked ~ .control-indicator::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--brand-primary-red);
        }
        .slds-checkbox input:checked ~ .control-indicator {
            background-color: var(--brand-white);
            border-color: var(--brand-primary-red);
        }
        /* CHECKMARK: MUST BE RED */
        .slds-checkbox input:checked ~ .control-indicator::after {
            content: '';
            position: absolute;
            left: 6px;
            top: 2px;
            width: 5px;
            height: 10px;
            border: solid var(--brand-primary-red);
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }
        .slds-radio:hover .control-indicator, .slds-checkbox:hover .control-indicator {
            border-color: var(--brand-mid-grey);
        }
        .slds-radio input:focus-visible ~ .control-indicator, .slds-checkbox input:focus-visible ~ .control-indicator {
            box-shadow: var(--brand-focus-shadow);
        }

        /* File Upload */
        .slds-file-selector {
            position: relative;
            display: flex;
            align-items: stretch;
        }
        .slds-file-selector__label {
            display: inline-block;
            padding: var(--spacing-small) var(--spacing-medium);
            border: 1px solid var(--brand-light-grey);
            border-right: none;
            background-color: var(--brand-background-grey);
            white-space: nowrap;
            border-top-left-radius: var(--border-radius-medium);
            border-bottom-left-radius: var(--border-radius-medium);
        }
        .slds-file-selector__input {
            opacity: 0;
            position: absolute;
            width: 100%;
            height: 100%;
            cursor: pointer;
            top: 0;
            left: 0;
        }
        .slds-file-selector__text {
            flex-grow: 1;
            padding: var(--spacing-small) var(--spacing-medium);
            border: 1px solid var(--brand-light-grey);
            border-top-right-radius: var(--border-radius-medium);
            border-bottom-right-radius: var(--border-radius-medium);
            background-color: var(--brand-white);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        #tfn-upload-input:focus-visible + .slds-file-selector .slds-file-selector__text {
            box-shadow: var(--brand-focus-shadow);
            border-color: var(--brand-trusted-blue);
        }

        /* --- BUTTONS --- */
        .slds-button {
            font-size: 1rem;
            font-weight: 600;
            padding: var(--spacing-small) var(--spacing-large);
            border-radius: var(--border-radius-medium);
            border: 1px solid transparent;
            cursor: pointer;
            transition: background-color 0.2s ease, opacity 0.2s ease;
        }
        .slds-button--primary {
            background-color: var(--brand-primary-red);
            color: var(--brand-white);
            border-color: var(--brand-primary-red);
        }
        .slds-button--primary:hover {
            background-color: #a10c02; /* Darker red */
        }
        .slds-button:disabled {
            background-color: var(--brand-border-grey);
            color: var(--brand-light-grey);
            border-color: var(--brand-border-grey);
            cursor: not-allowed;
        }
        .slds-button:focus-visible {
            outline: none;
            box-shadow: var(--brand-focus-shadow);
        }

        /* --- CONDITIONAL SECTIONS & TRANSITIONS --- */
        .conditional-section {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out, padding 0.5s ease-in-out;
            padding: 0;
            border-bottom: 1px solid var(--brand-border-grey);
        }
        .conditional-section.visible {
            max-height: 1000px; /* Large enough to not clip content */
            opacity: 1;
            padding: var(--spacing-large) 0;
        }

        /* --- UTILITIES & HELPERS --- */
        .is-required .slds-form-element__label::after {
            content: '*';
            color: var(--brand-primary-red);
            margin-left: var(--spacing-x-small);
        }
        .error-message {
            color: var(--brand-error-red);
            font-size: 0.875rem;
            margin-top: var(--spacing-small);
            display: none;
        }
        .slds-form-element.has-error .error-message {
            display: block;
        }

        /* --- PAGE STATES (LOADING, SUCCESS, EXPIRED) --- */
        .state-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            z-index: 1000;
        }
        .state-overlay.is-active {
            opacity: 1;
            visibility: visible;
        }
        .state-content {
            background: var(--brand-white);
            padding: var(--spacing-x-large);
            border-radius: var(--border-radius-medium);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            text-align: center;
            max-width: 400px;
        }
        .spinner {
            border: 4px solid var(--brand-background-grey);
            border-top: 4px solid var(--brand-primary-red);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--spacing-medium) auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .icon-success, .icon-expired {
            width: 60px;
            height: 60px;
            margin: 0 auto var(--spacing-medium) auto;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <main class="page-container">
        <div class="form-card" id="form-card">
            <header class="card-header">
                <svg class="logo" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Company Logo">
                   <text x="10" y="30" font-family="var(--font-family-sans)" font-size="28" font-weight="bold" fill="#C10E02">LEGAL AID</text>
                   <text x="125" y="30" font-family="var(--font-family-sans)" font-size="28" fill="#1D1D1D">NSW</text>
                </svg>
                <h1 class="heading-1">Interim Benefit Offer</h1>
                <p class="body-paragraph">Please review your offer and respond below.</p>
            </header>

            <form id="interim-benefit-form" class="card-body" novalidate>
                <section class="form-section">
                    <h2 class="heading-3">Your Details</h2>
                    <div class="info-grid">
                        <div class="slds-form-element">
                            <label class="body-small-strong" for="worker-name">Injured Worker Name</label>
                            <input type="text" id="worker-name" class="slds-input" value="Jessica Pearson" readonly>
                        </div>
                        <div class="slds-form-element">
                            <label class="body-small-strong" for="claim-number">Claim Number</label>
                            <input type="text" id="claim-number" class="slds-input" value="CLM-00012345" readonly>
                        </div>
                    </div>
                </section>
                
                <!-- Medical Expenses Offer -->
                <section class="form-section">
                    <h2 class="heading-3">Medical Expenses</h2>
                    <p class="body-paragraph">Are you intending to claim medical expenses while your claim is being assessed?</p>
                    <div class="slds-form-element" style="margin-top: 16px;">
                        <div class="slds-radio">
                            <label>
                                <input type="radio" name="medical-expenses" value="yes" required>
                                <span class="control-indicator"></span>
                                <span class="control-text">Yes</span>
                            </label>
                        </div>
                        <div class="slds-radio">
                            <label>
                                <input type="radio" name="medical-expenses" value="no">
                                <span class="control-indicator"></span>
                                <span class="control-text">No</span>
                            </label>
                        </div>
                    </div>
                </section>

                <!-- Income Support Offer -->
                <section class="form-section">
                    <h2 class="heading-3">Income Support</h2>
                     <div class="info-grid">
                        <div class="slds-form-element">
                            <label class="body-small-strong" for="weekly-benefit">Weekly Benefit Amount</label>
                            <input type="text" id="weekly-benefit" class="slds-input" value="$850.00" readonly>
                        </div>
                        <div class="slds-form-element">
                            <label class="body-small-strong" for="start-date">Start Date</label>
                            <input type="text" id="start-date" class="slds-input" value="25 July 2024" readonly>
                        </div>
                    </div>
                    <p class="body-paragraph">Do you accept this weekly benefit amount?</p>
                     <div class="slds-form-element" style="margin-top: 16px;">
                        <div class="slds-radio">
                            <label>
                                <input type="radio" name="income-support" value="yes" required>
                                <span class="control-indicator"></span>
                                <span class="control-text">Accept</span>
                            </label>
                        </div>
                        <div class="slds-radio">
                            <label>
                                <input type="radio" name="income-support" value="no">
                                <span class="control-indicator"></span>
                                <span class="control-text">Not Accept</span>
                            </label>
                        </div>
                    </div>
                </section>
                
                <!-- Conditional: EFT Details -->
                <section id="eft-section" class="conditional-section">
                    <h2 class="heading-3">Bank Account Details (EFT)</h2>
                    <p class="body-paragraph">Please provide your bank details for payments.</p>
                    <div class="slds-form-element is-required" style="margin-top: 16px;">
                        <label class="slds-form-element__label" for="account-name">Account Name</label>
                        <input type="text" id="account-name" class="slds-input" placeholder="e.g., J Pearson">
                    </div>
                    <div class="slds-form-element is-required">
                        <label class="slds-form-element__label" for="bsb">BSB</label>
                        <input type="text" id="bsb" class="slds-input" placeholder="e.g., 000-000" pattern="\d{3}-?\d{3}">
                    </div>
                    <div class="slds-form-element is-required">
                        <label class="slds-form-element__label" for="account-number">Account Number</label>
                        <input type="text" id="account-number" class="slds-input" placeholder="e.g., 123456789" pattern="\d{6,9}">
                    </div>
                </section>

                <!-- Conditional: TFN Upload -->
                <section id="tfn-section" class="conditional-section">
                     <h2 class="heading-3">Tax File Number (TFN) Declaration</h2>
                     <p class="body-paragraph">To ensure your payments are taxed correctly, please upload a completed TFN Declaration form.</p>
                     <div class="slds-form-element is-required" style="margin-top: 16px;">
                        <label class="slds-form-element__label" for="tfn-upload-input">Upload TFN Declaration Form</label>
                        <div class="slds-form-element__control">
                            <input type="file" id="tfn-upload-input" class="slds-file-selector__input" accept=".pdf,.doc,.docx,.jpg,.png">
                            <div class="slds-file-selector" aria-hidden="true">
                                <label for="tfn-upload-input" class="slds-file-selector__label">Upload File</label>
                                <span id="tfn-filename" class="slds-file-selector__text">No file selected...</span>
                            </div>
                        </div>
                     </div>
                </section>

                <!-- Conditional: Declaration -->
                <section id="declaration-section" class="form-section">
                    <div class="slds-form-element" id="declaration-wrapper">
                        <div class="slds-checkbox">
                            <label>
                                <input type="checkbox" id="declaration-checkbox" name="declaration">
                                <span class="control-indicator"></span>
                                <span class="control-text">I understand that by not accepting an offer, there may be a delay in receiving support.</span>
                            </label>
                        </div>
                        <div id="declaration-error" class="error-message">This declaration is required if you do not accept an offer.</div>
                    </div>
                </section>

            </form>
            <footer class="card-footer">
                <button type="submit" id="submit-button" form="interim-benefit-form" class="slds-button slds-button--primary" disabled>Submit Response</button>
            </footer>
        </div>

        <!-- Loading State Overlay -->
        <div id="loading-overlay" class="state-overlay">
            <div class="state-content">
                <div class="spinner"></div>
                <h2 class="heading-3">Submitting Response...</h2>
                <p class="body-paragraph">Please wait a moment.</p>
            </div>
        </div>

        <!-- Success State Overlay -->
        <div id="success-overlay" class="state-overlay">
            <div class="state-content">
                <svg class="icon-success" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="#21A179"/></svg>
                <h2 class="heading-3">Response Submitted Successfully</h2>
                <p class="body-paragraph">Thank you. Your response has been recorded. This page will now close.</p>
            </div>
        </div>
        
        <!-- Expired Link State -->
        <div id="expired-card" class="form-card hidden" style="text-align: center;">
             <div class="card-body" style="padding: 48px 32px;">
                 <svg class="icon-expired" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z" fill="#C10E02"/></svg>
                <h2 class="heading-3">Link Expired</h2>
                <p class="body-paragraph">This link has already been used to submit a response and is no longer active. If you have any questions, please contact your case manager.</p>
            </div>
        </div>

    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- DOM Element References ---
        const form = document.getElementById('interim-benefit-form');
        const medicalRadios = form.querySelectorAll('input[name="medical-expenses"]');
        const incomeRadios = form.querySelectorAll('input[name="income-support"]');
        
        const eftSection = document.getElementById('eft-section');
        const tfnSection = document.getElementById('tfn-section');
        const declarationSection = document.getElementById('declaration-section');
        
        const eftInputs = eftSection.querySelectorAll('input');
        const tfnInput = document.getElementById('tfn-upload-input');
        const declarationCheckbox = document.getElementById('declaration-checkbox');
        const declarationWrapper = document.getElementById('declaration-wrapper');
        const declarationError = document.getElementById('declaration-error');
        
        const submitButton = document.getElementById('submit-button');
        const tfnFilename = document.getElementById('tfn-filename');

        // --- State Management ---
        let state = {
            medicalResponse: null, // 'yes' or 'no'
            incomeResponse: null,  // 'yes' or 'no'
        };

        // --- Event Listeners ---
        form.addEventListener('change', handleFormChange);
        form.addEventListener('submit', handleFormSubmit);
        tfnInput.addEventListener('change', updateTfnFilename);
        
        // --- Core Logic Functions ---
        function handleFormChange(event) {
            const { name, value, type } = event.target;

            if (name === 'medical-expenses') {
                state.medicalResponse = value;
            } else if (name === 'income-support') {
                state.incomeResponse = value;
            }
            
            updateConditionalSections();
            updateFormValidity();
        }

        function updateConditionalSections() {
            const isMedicalAccepted = state.medicalResponse === 'yes';
            const isIncomeAccepted = state.incomeResponse === 'yes';

            // Show EFT if ANY offer is accepted
            const showEft = isMedicalAccepted || isIncomeAccepted;
            toggleSection(eftSection, showEft, eftInputs);

            // Show TFN only if INCOME is accepted
            const showTfn = isIncomeAccepted;
            toggleSection(tfnSection, showTfn, [tfnInput]);

            // Make declaration mandatory if ANY offer is NOT accepted
            const isAnyOfferRejected = state.medicalResponse === 'no' || state.incomeResponse === 'no';
            const isResponseComplete = state.medicalResponse && state.incomeResponse;

            if (isResponseComplete && isAnyOfferRejected) {
                declarationSection.style.display = 'block';
                declarationCheckbox.required = true;
                declarationWrapper.classList.add('is-required');
            } else {
                declarationSection.style.display = 'none';
                declarationCheckbox.required = false;
                declarationCheckbox.checked = false; // Reset if it becomes hidden
                declarationWrapper.classList.remove('is-required');
                declarationWrapper.classList.remove('has-error');
            }
        }

        function toggleSection(sectionElement, show, inputs) {
            if (show) {
                sectionElement.classList.add('visible');
                inputs.forEach(input => input.required = true);
            } else {
                sectionElement.classList.remove('visible');
                inputs.forEach(input => {
                    input.required = false;
                    input.value = ''; // Clear value if hidden
                    if (input.type === 'file') {
                        updateTfnFilename();
                    }
                });
            }
        }

        function updateFormValidity() {
            // A simple check if all required fields are filled.
            // The browser's `checkValidity()` handles the logic for us based on the `required` attribute.
            const isFormValid = form.checkValidity();
            submitButton.disabled = !isFormValid;

            // Custom validation message for declaration
            if (declarationCheckbox.required && !declarationCheckbox.checked) {
                declarationWrapper.classList.add('has-error');
            } else {
                declarationWrapper.classList.remove('has-error');
            }
        }

        function updateTfnFilename() {
            if (tfnInput.files && tfnInput.files.length > 0) {
                tfnFilename.textContent = tfnInput.files[0].name;
            } else {
                tfnFilename.textContent = 'No file selected...';
            }
        }

        async function handleFormSubmit(event) {
            event.preventDefault();
            
            if (!form.checkValidity()) {
                // This will trigger native browser validation UI
                form.reportValidity();
                updateFormValidity(); // Re-run to show custom messages
                return;
            }

            // --- Show Loading State ---
            const loadingOverlay = document.getElementById('loading-overlay');
            loadingOverlay.classList.add('is-active');

            // --- Simulate API call ---
            await new Promise(resolve => setTimeout(resolve, 2000));

            // --- Show Success State ---
            loadingOverlay.classList.remove('is-active');
            const successOverlay = document.getElementById('success-overlay');
            successOverlay.classList.add('is-active');
            
            // --- Simulate URL expiration ---
            await new Promise(resolve => setTimeout(resolve, 3000));

            const formCard = document.getElementById('form-card');
            const expiredCard = document.getElementById('expired-card');

            formCard.style.opacity = '0';
            formCard.style.transform = 'scale(0.95)';
            successOverlay.classList.remove('is-active');

            setTimeout(() => {
                formCard.classList.add('hidden');
                expiredCard.classList.remove('hidden');
            }, 300);
        }
        
        // --- Initial State Setup ---
        declarationSection.style.display = 'none'; // Hide declaration until a choice is made
    });
    </script>

</body>
</html>